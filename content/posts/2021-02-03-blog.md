---
title: "github+Typora博客搭建方案"
date: 2021-02-03T00:00:00+08:00
draft: true
toc: true
tags: ["blog"]
categories: ["生活多美好"]
---

## 环境

+ 平台：github pages
+ 框架：hugo
+ 主题：LoveIt
+ 编辑器：Typora

## 搭建记录

{{< admonition quote >}}

完整搭建文档可参考：https://hugoloveit.com/zh-cn/

{{< /admonition >}}

### 本地安装hugo

​	{{< admonition note "关于Hugo" >}}

​	Hugo是由Go语言实现的静态网站生成器。简单、易用、高效、易扩展、快速部署。

​	{{< /admonition >}}

+ Hugo需要先安装Go语言环境

+ 在官方github仓库下载对应操作系统的Hugo的zip包

+ 将下载好的zip包解压到Go安装目录的bin目录下

+ Hugo 提供了一个 `new` 命令来创建一个新的网站

  ```bash
  hugo new site my_website
  cd my_website
  ```


### 导入主题

+ github上下载最新版LoveIt主题：https://github.com/dillonzq/LoveIt.

+ 下载好的zip包解压到`my_website`下的`themes`目录

  {{< admonition note "注意" >}}config.toml里的theme参数要和主题目录的名称一致，否则在构建网站时会报错{{< /admonition >}}

### 配置网站

+ 编写`my_website`下的config.tmol文件
+ 可以参考官方给出的例子：https://hugoloveit.com/zh-cn/theme-documentation-basics/#basic-configuration

### 构建本地网站

```bash
hugo serve --disableFastRender
# --disableFastRender可以通过hugo的.Scratch来实现实时预览文章效果
```

+ 通过`localhost:1313`可以访问本地搭建的网站
+ 当修改文件时，网站会自动进行更新

### 导入博文

+ 博文的源文件在`my_website`下的content/posts

+ 可以在文章的内容前面加上yaml格式或json格式的元数据参数

  ```yaml
  # 常用
  ---
  title: "文章标题"
  date: 2021-02-03T00:00:00+08:00
  draft: false (是否为草稿，如果在hugo serve中加入了参数--buildDrafts/-D，将决定此篇文章是否显示在主页)
  toc: true (是否启用目录)
  tags: ["blog"] (标签)
  categories: ["生活多美好"] (分类)
  lightgallery: true (是否启用lightgallery)
  ---
  文章正文
  ```

#### 图片链接

+ 在assets目录下，每个文章都单独建立一个名为`文章名.assets`的文件夹用于放置图片。
+ assets目录用于放置静态资源，在文章中引用的时候，可以以assets目录为根目录来引用。
+ 在本地编辑文章时，我使用的是typora，可以在软件中设置将图片复制到当前目录下的`文章名.assets`目录，这样转移到博客网站时，只需要批量修改下引用链接，在开头加上“/”就可以了。

### 推送到github

+ 使用github pages来搭建hugo博客的原理是，在本地先使用hugo生成网站文件，再将包含网站文件的目录推送到github上。也就是hugo会将我们所有的源文件自动转换成网页。

+ 先在源文件的根目录下执行`hugo`命令生成网站文件，网站文件输出的目录，可以在config.toml中配置“publishDir”参数。

  ```bash
  $ hugo
  Start building sites …
  
                     | ZH-CN
  -------------------+--------
    Pages            |    82
    Paginator pages  |     1
    Non-page files   |     0
    Static files     |    94
    Processed images |     0
    Aliases          |    22
    Sitemaps         |     1
    Cleaned          |     0
  
  Total in 3026 ms
  ```

+ 完成之后，根目录下会出现一个新目录，其中包含的就是我们转换后得到的网站文件。

  ```bash
  $ ls -l
  total 37
  drwxr-xr-x 1 liuchong 197609     0  1月 31 19:58 archetypes/
  drwxr-xr-x 1 liuchong 197609     0  2月  9 14:45 assets/
  -rw-r--r-- 1 liuchong 197609    19  1月 31 19:58 CNAME
  -rw-r--r-- 1 liuchong 197609 16770  1月 31 19:58 config.toml
  drwxr-xr-x 1 liuchong 197609     0  1月 31 19:58 content/
  drwxr-xr-x 1 liuchong 197609     0  8月 31  1754 docs/  <-- 这就是我们的网站文件目录
  -rw-r--r-- 1 liuchong 197609  7169  1月 31 19:58 LICENSE
  drwxr-xr-x 1 liuchong 197609     0  1月 31 19:59 resources/
  drwxr-xr-x 1 liuchong 197609     0  1月 31 19:58 static/
  drwxr-xr-x 1 liuchong 197609     0  1月 31 19:58 themes/
  ```

+ 现在我们就可以用git推送到自己的仓库啦。

  ```bash
  $ git add *
  $ git commit -m "初始化网站"
  $ git push origin main
  ```

  {{< admonition note "注意" >}}

  由于我之前存在一个用于博客的仓库，所以可以直接将其下载到本地，附加上我们本次创建的文件再推送到仓库。如果没有的话，就需要自己先建立一个仓库。

  {{< /admonition >}}

+ 进入github页面，在仓库的setting页面设置github pages。因为我的网站文件全部在“docs”目录下，所以我将网站的根目录也设置为“docs”。

  ![image-20210209230354317](2021-02-03-blog.assets/image-20210209230354317.png "设置网站目录")

+ 最后配置好cname记录，就可以愉快地访问自己的网站了！

## 优化

### 配置cdn

+ 对于国内访问github，还是不太稳定，最好的办法就是给网站配置一个好用的cdn。

+ 鉴于国内各大厂商的服务费用和备案限制，决定还是试一试cloudflare的免费版加速。

+ 注册cloudflare账号后，有非常详细的教程，一步一步教你如何设置。

  {{< admonition question "这是个糟糕的解决方法" >}}

  cloudflare虽说有免费服务，其可用的节点基本也都在北美，而github的服务器也在北美，其实和没有加速是一样的。。

  {{< /admonition >}}

## 待优化

### 自动化

### 图床

+ 考虑使用阿里云oss来搭建图床，较为便宜，对于国内访问来说，图片加载也更快，可以替代cdn。

